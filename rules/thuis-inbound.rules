	
var String MspUpdate = ""

var Boolean inPackage = false


rule "MSP on update"
	when 
		Item Msp received update
	then
		//Every package starts with [ (this did i determine myserlf :)
		
		if(Msp.state.toString.trim.notBlank){
	    		MspUpdate = MspUpdate + Msp.state.toString.trim
	    		inPackage= true;
	    }
	 	//logic to handle the actual meaning of the package
		//we delimmit the packages with 3x ;;; to enable us to use non-determined package lenghts (<29byte ofcourse ;))
		if (MspUpdate.contains("\n")) {
				if (MspUpdate.substring(0,1).equals("r")) {
					println("Received remote command: " + MspUpdate)
				}
				else if (MspUpdate.substring(0,1).equals("c")){
					println("received Temperature: " + MspUpdate)
				}
				else
				{
					println("unknown package: " + MspUpdate);
				}
				MspUpdate = ""
				
		  }
end
